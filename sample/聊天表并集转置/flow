{
  "parameters" : {
    "parameters" : { }
  },
  "initialNodes" : [ "f1f73a0e-15ee-490d-9958-7bcc8fa1c599", "451bb559-e00c-4a84-9d76-9a94a5488aca" ],
  "nodes" : {
    "b24be59a-39b5-4409-b487-0fbe291eddfe" : {
      "nodeType" : ".v2018_3_3.SuperPivot",
      "name" : "转置 1",
      "id" : "b24be59a-39b5-4409-b487-0fbe291eddfe",
      "baseType" : "superNode",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "6d3a11c2-f55c-46a5-81a1-64a78c2cd44c",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "beforeActionAnnotations" : [ ],
      "afterActionAnnotations" : [ ],
      "actionNode" : {
        "nodeType" : ".v2018_3_3.Pivot",
        "name" : "name 1",
        "id" : "b762c843-8837-4a7d-a889-d5f07f7dc649",
        "baseType" : "transform",
        "nextNodes" : [ ],
        "serialize" : false,
        "description" : null,
        "defaultAggregation" : "COUNT",
        "aggregateColumnName" : "id",
        "pivotColumnName" : "month_label",
        "pivotGroupingColumns" : [ ],
        "newPivotColumns" : [ {
          "newColumnName" : "2026-01"
        }, {
          "newColumnName" : "2026-02"
        } ]
      }
    },
    "75e4bdb2-90d9-4be7-aaca-4fafdccd8b04" : {
      "nodeType" : ".v1.PublishExtract",
      "name" : "输出",
      "id" : "75e4bdb2-90d9-4be7-aaca-4fafdccd8b04",
      "baseType" : "output",
      "nextNodes" : [ ],
      "serialize" : false,
      "description" : null,
      "projectName" : "数据源",
      "projectLuid" : "7fa01ebc-72f4-4fd0-a27f-f8ac1e30ac20",
      "datasourceName" : "聊天表并集和列转行",
      "datasourceDescription" : "",
      "serverUrl" : "http://win-picvs30bivi"
    },
    "6d3a11c2-f55c-46a5-81a1-64a78c2cd44c" : {
      "nodeType" : ".v1.Container",
      "name" : "清理 4",
      "id" : "6d3a11c2-f55c-46a5-81a1-64a78c2cd44c",
      "baseType" : "container",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "c20ed8c8-8b15-4e93-81f5-0cbf509e9ccb",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "loomContainer" : {
        "parameters" : {
          "parameters" : { }
        },
        "initialNodes" : [ ],
        "nodes" : { },
        "connections" : { },
        "dataConnections" : { },
        "connectionIds" : [ ],
        "dataConnectionIds" : [ ],
        "nodeProperties" : { },
        "extensibility" : null
      },
      "namespacesToInput" : { },
      "namespacesToOutput" : { },
      "providedParameters" : null
    },
    "3eed32c2-784f-4049-a791-85b26ca01524" : {
      "nodeType" : ".v1.Container",
      "name" : "清理 1",
      "id" : "3eed32c2-784f-4049-a791-85b26ca01524",
      "baseType" : "container",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "a8c94e0f-47c1-4cf5-a05a-b10b2383e5ce",
        "nextNamespace" : "Union-Namespace-4670dedb-05e2-41d3-be89-0c66c81a77ef"
      } ],
      "serialize" : false,
      "description" : null,
      "loomContainer" : {
        "parameters" : {
          "parameters" : { }
        },
        "initialNodes" : [ ],
        "nodes" : { },
        "connections" : { },
        "dataConnections" : { },
        "connectionIds" : [ ],
        "dataConnectionIds" : [ ],
        "nodeProperties" : { },
        "extensibility" : null
      },
      "namespacesToInput" : { },
      "namespacesToOutput" : { },
      "providedParameters" : null
    },
    "f1f73a0e-15ee-490d-9958-7bcc8fa1c599" : {
      "nodeType" : ".v1.LoadSql",
      "name" : "e_vdata_message_202601",
      "id" : "f1f73a0e-15ee-490d-9958-7bcc8fa1c599",
      "baseType" : "input",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "3eed32c2-784f-4049-a791-85b26ca01524",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "connectionId" : "0272d16f-088c-4a11-900f-4a68851fce7a",
      "connectionAttributes" : {
        "dbname" : "voxadmin"
      },
      "fields" : [ {
        "name" : "month_label",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 1,
        "isGenerated" : false
      }, {
        "name" : "id",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 2,
        "isGenerated" : false
      }, {
        "name" : "staff_wechat_id",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 3,
        "isGenerated" : false
      }, {
        "name" : "customer_wechat_id",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 4,
        "isGenerated" : false
      }, {
        "name" : "message_time",
        "type" : "datetime",
        "collation" : null,
        "caption" : "",
        "ordinal" : 5,
        "isGenerated" : false
      }, {
        "name" : "hour_of_day",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 6,
        "isGenerated" : false
      }, {
        "name" : "msg_type",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 7,
        "isGenerated" : false
      }, {
        "name" : "IsSender",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 8,
        "isGenerated" : false
      }, {
        "name" : "staff_id",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 9,
        "isGenerated" : false
      } ],
      "actions" : [ ],
      "debugModeRowLimit" : 393216,
      "originalDataTypes" : { },
      "randomSampling" : null,
      "updateTimestamp" : 1770532865677,
      "restrictedFields" : { },
      "userRenamedFields" : { },
      "selectedFields" : null,
      "samplingType" : null,
      "groupByFields" : null,
      "filters" : [ ],
      "relation" : {
        "type" : "query",
        "query" : "-- 场景 3：服务响应时段分析 - 2026年1月数据抽取\n-- 目的：抽取明细数据用于并集(Union)和转置(Pivot)测试\nSELECT \n    '2026-01' AS `month_label`,\n    id,\n    UserName AS `staff_wechat_id`, -- 坐席/销售微信ID\n    Talker AS `customer_wechat_id`, -- 好友/客户微信ID\n    FROM_UNIXTIME(`Time`) AS `message_time`, -- Unix时间戳转换为标准时间\n    HOUR(FROM_UNIXTIME(`Time`)) AS `hour_of_day`, -- 提取小时维度，方便转置对比各时段活跃度\n    `Type` AS `msg_type`, -- 消息类型 (1=文字, 3=图片等)\n    IsSender, -- 1=销售发送, 0=客户发送\n    UserId AS `staff_id`\nFROM e_vdata_message_202601\nLIMIT 100"
      }
    },
    "ea408ae1-f297-4e7f-b28b-52e460f81c09" : {
      "nodeType" : ".v1.Container",
      "name" : "清理 2",
      "id" : "ea408ae1-f297-4e7f-b28b-52e460f81c09",
      "baseType" : "container",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "a8c94e0f-47c1-4cf5-a05a-b10b2383e5ce",
        "nextNamespace" : "Union-Namespace-398c804d-0749-4379-96be-ec5e50204ab3"
      } ],
      "serialize" : false,
      "description" : null,
      "loomContainer" : {
        "parameters" : {
          "parameters" : { }
        },
        "initialNodes" : [ ],
        "nodes" : { },
        "connections" : { },
        "dataConnections" : { },
        "connectionIds" : [ ],
        "dataConnectionIds" : [ ],
        "nodeProperties" : { },
        "extensibility" : null
      },
      "namespacesToInput" : { },
      "namespacesToOutput" : { },
      "providedParameters" : null
    },
    "a8c94e0f-47c1-4cf5-a05a-b10b2383e5ce" : {
      "nodeType" : ".v2018_2_3.SuperUnion",
      "name" : "并集 1",
      "id" : "a8c94e0f-47c1-4cf5-a05a-b10b2383e5ce",
      "baseType" : "superNode",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "c22fc18c-5d8b-4bb5-9e3b-d4a83d2c6dd4",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "beforeActionAnnotations" : [ ],
      "afterActionAnnotations" : [ {
        "namespace" : "Default",
        "annotationNode" : {
          "nodeType" : ".v1.RemoveColumns",
          "name" : "移除“Table Names” 1",
          "id" : "757939c8-922d-44b6-ab49-ba2b969cf4fb",
          "baseType" : "transform",
          "nextNodes" : [ ],
          "serialize" : false,
          "description" : null,
          "columnNames" : [ "Table Names" ]
        }
      } ],
      "actionNode" : {
        "nodeType" : ".v1.SimpleUnion",
        "name" : "并集 1",
        "id" : "0ddb9c9e-d036-4fd2-aec6-f3e81a294fb8",
        "baseType" : "transform",
        "nextNodes" : [ ],
        "serialize" : false,
        "description" : null,
        "namespaceFieldMappings" : [ {
          "namespaceName" : "Union-Namespace-398c804d-0749-4379-96be-ec5e50204ab3",
          "fieldMappings" : { }
        }, {
          "namespaceName" : "Union-Namespace-4670dedb-05e2-41d3-be89-0c66c81a77ef",
          "fieldMappings" : { }
        } ]
      }
    },
    "451bb559-e00c-4a84-9d76-9a94a5488aca" : {
      "nodeType" : ".v1.LoadSql",
      "name" : "e_vdata_message_202602",
      "id" : "451bb559-e00c-4a84-9d76-9a94a5488aca",
      "baseType" : "input",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "ea408ae1-f297-4e7f-b28b-52e460f81c09",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "connectionId" : "0272d16f-088c-4a11-900f-4a68851fce7a",
      "connectionAttributes" : {
        "dbname" : "voxadmin"
      },
      "fields" : [ {
        "name" : "month_label",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 1,
        "isGenerated" : false
      }, {
        "name" : "id",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 2,
        "isGenerated" : false
      }, {
        "name" : "staff_wechat_id",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 3,
        "isGenerated" : false
      }, {
        "name" : "customer_wechat_id",
        "type" : "string",
        "collation" : "LROOT_S2",
        "caption" : "",
        "ordinal" : 4,
        "isGenerated" : false
      }, {
        "name" : "message_time",
        "type" : "datetime",
        "collation" : null,
        "caption" : "",
        "ordinal" : 5,
        "isGenerated" : false
      }, {
        "name" : "hour_of_day",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 6,
        "isGenerated" : false
      }, {
        "name" : "msg_type",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 7,
        "isGenerated" : false
      }, {
        "name" : "IsSender",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 8,
        "isGenerated" : false
      }, {
        "name" : "staff_id",
        "type" : "integer",
        "collation" : null,
        "caption" : "",
        "ordinal" : 9,
        "isGenerated" : false
      } ],
      "actions" : [ ],
      "debugModeRowLimit" : 393216,
      "originalDataTypes" : { },
      "randomSampling" : null,
      "updateTimestamp" : 1770532866672,
      "restrictedFields" : { },
      "userRenamedFields" : { },
      "selectedFields" : null,
      "samplingType" : null,
      "groupByFields" : null,
      "filters" : [ ],
      "relation" : {
        "type" : "query",
        "query" : "-- 场景 3：服务响应时段分析 - 2026年2月数据抽取\n-- 目的：抽取明细数据用于并集(Union)和转置(Pivot)测试\nSELECT \n    '2026-02' AS `month_label`,\n    id,\n    UserName AS `staff_wechat_id`, -- 坐席/销售微信ID\n    Talker AS `customer_wechat_id`, -- 好友/客户微信ID\n    FROM_UNIXTIME(`Time`) AS `message_time`, -- Unix时间戳转换为标准时间\n    HOUR(FROM_UNIXTIME(`Time`)) AS `hour_of_day`, -- 提取小时维度，方便转置对比各时段活跃度\n    `Type` AS `msg_type`, -- 消息类型 (1=文字, 3=图片等)\n    IsSender, -- 1=销售发送, 0=客户发送\n    UserId AS `staff_id`\nFROM e_vdata_message_202602\nLIMIT 100"
      }
    },
    "9e50bdf4-c9aa-4367-aab5-eaf3b0b2e177" : {
      "nodeType" : ".v1.Container",
      "name" : "清理 5",
      "id" : "9e50bdf4-c9aa-4367-aab5-eaf3b0b2e177",
      "baseType" : "container",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "75e4bdb2-90d9-4be7-aaca-4fafdccd8b04",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "loomContainer" : {
        "parameters" : {
          "parameters" : { }
        },
        "initialNodes" : [ ],
        "nodes" : { },
        "connections" : { },
        "dataConnections" : { },
        "connectionIds" : [ ],
        "dataConnectionIds" : [ ],
        "nodeProperties" : { },
        "extensibility" : null
      },
      "namespacesToInput" : { },
      "namespacesToOutput" : { },
      "providedParameters" : null
    },
    "c20ed8c8-8b15-4e93-81f5-0cbf509e9ccb" : {
      "nodeType" : ".v2018_2_3.SuperUnpivot",
      "name" : "转置 2",
      "id" : "c20ed8c8-8b15-4e93-81f5-0cbf509e9ccb",
      "baseType" : "superNode",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "9e50bdf4-c9aa-4367-aab5-eaf3b0b2e177",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "beforeActionAnnotations" : [ ],
      "afterActionAnnotations" : [ {
        "namespace" : "Default",
        "annotationNode" : {
          "nodeType" : ".v1.RenameColumn",
          "columnName" : "转置 1 名称",
          "rename" : "role",
          "name" : "将 转置 1 名称 重命名为 role 1",
          "id" : "0b942456-5532-4317-b715-c40aa5a7c8d8",
          "baseType" : "transform",
          "nextNodes" : [ ],
          "serialize" : false,
          "description" : null
        }
      }, {
        "namespace" : "Default",
        "annotationNode" : {
          "nodeType" : ".v1.RenameColumn",
          "columnName" : "转置1值",
          "rename" : "WeChatID",
          "name" : "将 转置1值 重命名为 WeChatID 1",
          "id" : "1b4e1c88-40dd-4729-a47b-ee2cf9327c8d",
          "baseType" : "transform",
          "nextNodes" : [ ],
          "serialize" : false,
          "description" : null
        }
      } ],
      "actionNode" : {
        "nodeType" : ".v1.Unpivot",
        "name" : "转置 2",
        "id" : "037df8c3-222a-45ed-83d2-94c720dc1c76",
        "baseType" : "transform",
        "nextNodes" : [ ],
        "serialize" : false,
        "description" : null,
        "usesSmartDefaults" : true,
        "unpivotGroups" : [ {
          "expressions" : [ {
            "bindings" : [ {
              "bindingType" : "literal",
              "newColumnName" : "转置 1 名称",
              "groupName" : "staff_wechat_id"
            }, {
              "bindingType" : "column",
              "newColumnName" : "转置1值",
              "columnName" : "staff_wechat_id"
            } ]
          }, {
            "bindings" : [ {
              "bindingType" : "literal",
              "newColumnName" : "转置 1 名称",
              "groupName" : "customer_wechat_id"
            }, {
              "bindingType" : "column",
              "newColumnName" : "转置1值",
              "columnName" : "customer_wechat_id"
            } ]
          } ]
        } ]
      }
    },
    "c22fc18c-5d8b-4bb5-9e3b-d4a83d2c6dd4" : {
      "nodeType" : ".v1.Container",
      "name" : "清理 3",
      "id" : "c22fc18c-5d8b-4bb5-9e3b-d4a83d2c6dd4",
      "baseType" : "container",
      "nextNodes" : [ {
        "namespace" : "Default",
        "nextNodeId" : "b24be59a-39b5-4409-b487-0fbe291eddfe",
        "nextNamespace" : "Default"
      } ],
      "serialize" : false,
      "description" : null,
      "loomContainer" : {
        "parameters" : {
          "parameters" : { }
        },
        "initialNodes" : [ ],
        "nodes" : { },
        "connections" : { },
        "dataConnections" : { },
        "connectionIds" : [ ],
        "dataConnectionIds" : [ ],
        "nodeProperties" : { },
        "extensibility" : null
      },
      "namespacesToInput" : { },
      "namespacesToOutput" : { },
      "providedParameters" : null
    }
  },
  "connections" : {
    "0272d16f-088c-4a11-900f-4a68851fce7a" : {
      "connectionType" : ".v1.SqlConnection",
      "id" : "0272d16f-088c-4a11-900f-4a68851fce7a",
      "name" : "rm-uf661w842h18w326nvo.mysql.rds.aliyuncs.com",
      "isPackaged" : false,
      "connectionAttributes" : {
        "odbc-connect-string-extras" : "",
        "sslmode" : "",
        "server" : "rm-uf661w842h18w326nvo.mysql.rds.aliyuncs.com",
        "prep-protocol-role" : ":prep-protocol-reader",
        ":flow-name" : "流程 1",
        "odbc-dbms-name" : "",
        ":use-allowlist" : "false",
        "dbname" : "voxadmin",
        "port" : "3306",
        ":protocol-customizations" : "",
        "source-charset" : "",
        "sslcert" : "",
        "expected-driver-version" : "",
        "one-time-sql" : "",
        "odbc-native-protocol" : "",
        "class" : "mysql",
        "username" : "link_BI",
        "authentication" : ""
      }
    }
  },
  "dataConnections" : { },
  "connectionIds" : [ "0272d16f-088c-4a11-900f-4a68851fce7a" ],
  "dataConnectionIds" : [ ],
  "nodeProperties" : { },
  "extensibility" : { },
  "selection" : [ ],
  "majorVersion" : 1,
  "minorVersion" : 3,
  "documentId" : "26f24abd-2200-45b5-a374-87ee09ac2356",
  "obfuscatorId" : "1997c86d-9845-4a82-83e8-d48bb31c6f03"
}